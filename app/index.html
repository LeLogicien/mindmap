<!DOCTYPE html>
<html>
<head>
  <title>xml parsing test</title>
  <meta http-equiv="Content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
</head>
<body>
  <script type="text/javascript" src="lib/jquery.js"></script>
  <script type="text/javascript">
    function dumpNode(n, d){
      var spaceStr = '';
      for (var i= 0; i<d; i++){
        spaceStr += "  ";
      }
      console.log(spaceStr
        + "{ "
        + "node-name: "+ n.nodeName+ ", "
        + "node-type: "+ n.nodeType+ ", "
        + "node-value: "+ n.nodeValue+ " }");
      
      var attrs = n.attributes;
      if (attrs){
        console.log(spaceStr+ spaceStr+ "attributes length= "+ attrs.length);
        for (var i=0; i<attrs.length; i++){
          var a = attrs.item(i);
          console.log(spaceStr+ spaceStr
            + "attr[ "+ i+ " ]: "
            + "attr-name: "+ a.nodeName+ ", "
            + "attr-type: "+ a.nodeType+ ", "
            + "attr-value: "+ a.nodeValue);
        }
      }
      
      var child = n.firstChild;
      while (child){
        dumpNode(child, d+1);
        child = child.nextSibling;
      }
    }
      
    /*
    var xmlStr
          = "<map version=\"0.9.0\">"
          + "<!-- To view this file, download free mind mapping software "
          +   "FreeMind from http://freemind.sourceforge.net -->"
          + "<node CREATED=\"3\" ID=\"1\" MODIFIED=\"2\" TEXT=\"new-map\">"
          +   "<node CREATED=\"1406119930596\" ID=\"ID_1238146207\" "
          +     "MODIFIED=\"1406119935806\" POSITION=\"right\" "
          +     "TEXT=\"this is A\"/>"
          +   "<node CREATED=\"1406119936230\" ID=\"ID_1428113166\" "
          +     "MODIFIED=\"1406119938198\" POSITION=\"right\" "
          +     "TEXT=\"this is B\"/>"
          +   "<node CREATED=\"1406119939270\" ID=\"ID_442146008\" "
          +     "MODIFIED=\"1406119942491\" POSITION=\"right\" "
          +     " TEXT=\"&#xc774;&#xac83;&#xc740; C\"/>"
          + "</node>"
          + "</map>";
    console.log("xml: "+ xmlStr);
    
    var xmlDoc = $.parseXML(xmlStr);
    console.log("xmlDoc.nodeName= "+ xmlDoc.nodeName);
    
    var node = xmlDoc.firstChild;
    while (node){
      dumpNode(node, 1);
      node = node.nextSibling;
    }
    */
    
    $.ajax({ url: "https://www.dropbox.com/s/uq1cjrrug1jgb3u/sample.mm?dl=0" })
      .done( function(xmlDoc){ 
        console.log("xmlDoc.nodeName= "+ xmlDoc.nodeName);
        var node = xmlDoc.firstChild;
        while (node){
          dumpNode(node, 1);
          node = node.nextSibling;
        }
      });
  </script>
</body>
</html>
